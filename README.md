# Doc2Vec-Search-Engine
Ananya Srinivasan,
<i>Intern, Ratings-Architecture</i>

<h4>Summary</h4>
<p>This is a proof of concept for a simple search engine using the Doc2Vec model (a relative of the Word2Vec model) to suggest recommended documents/quotes. The user can search for a topic and get relevant results, and then they can click the document to retrieve similar documents they may want to view. I initially used a corpus of dialogues from the Seinfeld TV Show. </p>

<h4>Doc2Vec</h4>
<p>Doc2Vec is an unsupervised learning algorithm and an adaptation of the <a href="https://code.google.com/archive/p/word2vec/"> Word2Vec</a> algorithm. The Doc2Vec algorithm takes documents, and paragraphs as input and generates vectors. The vectors generated by the model are used for tasks such as document similarity analysis. It is considered an relative of the Word2Vec, as it utilizes word vectors to represent document words.</p>

<h5>What is the difference between Doc2Vec and Word2Vec?</h5>
<p>Doc2Vec introduces an extra vector that represents the document itself (as shown by the paragraph-id vector). Word vectors are trained for each word and document vectors are trained for each document. Doc2Vec is useful for tasks where you need to determine the overall similarity of a document and not just between words.</p>

![alt text](https://github.com/sriniva5/Seinfeld-Doc2Vec/blob/master/Images/0_x-gtU4UlO8FAsRvL_.png)

<h4>Tools</h4>
<ul><li>Gensim: for Doc2Vec/Word2Vec Models</li>
<li>Flask: for the basic frontend</li>
<li>SQLAlchemy: for handling the database of documents</li>
</ul>

<h4>Corpus</h4>
<p>As I noted before, I used a csv file of Seinfeld scripts I obtained from <a href="https://www.kaggle.com/thec03u5/seinfeld-chronicles">Kaggle</a>. I converted the csv file into a SQLite database, and then used Python classes and methods to help query the data. I mainly used this dataset as a placeholder to see if I could generate similar documents using Doc2Vec based on a selected document. I intend to test most cohesive datasets to determine whether the model actually produces relevant documents when a document is passed into the Doc2Vec model.</p>

<h4>Results</h4>
<p>After testing the search functionality and Doc2Vec model results, I found some interesting results with the data.</p>

<p>I entered the query "Kessler" into the search bar and it produced the following documents with relevant quotes. This was just a basic SQL filter() method</p>

![alt text](https://github.cicd.spglobal.com/ANANYA-SRINIVASAN/Doc2Vec-Search-Engine/blob/Doc2Vec-Functionality/Images/ResponseExample.PNG)

<i>Document 90: Yeah. (Jerry sits down on the couch. Kessler walks over with his sandwich and looks at Jerry and uses expressions to ask Jerry to move the newspapers on the other side of the couch so he could site down. Kessler sits down next to him and starts turning over the pages of a magazine. Suddenly he spots an article he likes and tears it out. Jerry gives him a look as if to say, Do you mind?) Are you done with this?</i>

<p>After clicking the Doc2Vec hyperlink to the document I wanted (document 98), I was redirected to the results generated by the Doc2Vec model for similar documents</p>

![alt text](https://github.com/sriniva5/Seinfeld-Doc2Vec/blob/master/Images/ResponseExampleResults.PNG)

<p>There are some results that make sense with the question asked at the end of the document such as document 40's "Yes!" and and document 105's "I don't think so." The other documents produced seem to have no similarity. Thus, it would be ideal to choose documents within a similar domain and not from a program that has unexpected scenarios.</p>

<h4>Sources</h4>
<ol>
<li>https://radimrehurek.com/gensim/models/word2vec.html</li>
<li>https://medium.com/scaleabout/a-gentle-introduction-to-doc2vec-db3e8c0cce5e</li>
<li>http://www.sqlitetutorial.net/sqlite-import-csv/</li>
<li>http://www.blog.pythonlibrary.org/2017/12/13/flask-101-how-to-add-a-search-form/</li>
<li>https://stackoverflow.com/questions/42781292/doc2vec-get-most-similar-documents</li>
<li>https://github.com/RaRe-Technologies/gensim/blob/develop/docs/notebooks/doc2vec-lee.ipynb</li>
</ol>

<b>Work in Progress!</b>
